<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>AUSTISM CRC | RSVP</title>
    <link rel="shortcut icon" href="https://www.autismcrc.com.au/sites/default/files/favicon.ico" type="image/vnd.microsoft.icon" />
    <link rel='stylesheet prefetch' href='http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css'>
    <link rel='stylesheet prefetch' href='http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css'>
    <link rel='stylesheet prefetch' href='http://cdnjs.cloudflare.com/ajax/libs/jquery.bootstrapvalidator/0.5.0/css/bootstrapValidator.min.css'>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <div class="row centered margin0 bgcolor">
            <div class="col-sm-12 ">
                <img class="autism-logo" src="https://www.autismcrc.com.au/sites/default/files/logo.jpg">
            </div>
        </div>
        <form id="contact_form" class="well form-horizontal" method="POST" action="%%= RequestParameter('PAGEURL') =%%">
            <fieldset>
                <div class="Text-Box">
                    <p>Please fill out the details here:</p>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">First Name</label>
                    <div class="col-sm-9 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <input name="FirstName" placeholder="First Name" class="form-control" type="text">
                        </div>
                    </div>
                </div>
                <!-- Text input-->
                <div class="form-group">
                    <label class="col-sm-3 control-label">Surname</label>
                    <div class="col-sm-9 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <input name="Surname" placeholder="Last Name" class="form-control" type="text">
                        </div>
                    </div>
                </div>
                <!-- Text input-->
                <div class="form-group">
                    <label class="col-sm-3 control-label">E-Mail</label>
                    <div class="col-sm-9 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-envelope"></i></span>
                            <input name="email" placeholder="E-mail Address" class="form-control" type="email">
                        </div>
                    </div>
                </div>
                <!-- Select Basic -->
                <div class="form-group">
                    <label class="col-sm-3 control-label">Campaign Member Status</label>
                    <div class="col-sm-9 selectContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-list"></i></span>
                            <select name="Attendance_option" class="form-control selectpicker" id="attendance_opt">
                                <option value="">Please select one option</option>
                                <option value="Attending">Attending</option>
                                <option value="Declined">Declined</option>
                                <option value="Substitute_Attending">Substitute Attending devices</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="form-group hidenshow1">
                    <label class="col-sm-3 control-label">Substitute First Name</label>
                    <div class="col-sm-9 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <input name="SubFirstName" placeholder="Substitute's First Name" class="form-control" type="text">
                        </div>
                    </div>
                </div>
                <!-- Text input-->
                <div class="form-group hidenshow1">
                    <label class="col-sm-3 control-label"> Substitute Surname</label>
                    <div class="col-sm-9 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <input name="SubSurname" placeholder="Substitute's Last Name" class="form-control" type="text">
                        </div>
                    </div>
                </div>
                <!-- Text input-->
                <div class="form-group hidenshow1">
                    <label class="col-sm-3 control-label">Substitute E-Mail</label>
                    <div class="col-sm-9 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-envelope"></i></span>
                            <input name="Subemail" placeholder="Substitute's E-mail Address" class="form-control" type="email">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label p-t-0">Dietry Requirements ?</label>
                    <div class="col-sm-9 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-pencil"></i></span>
                            <textarea class="form-control" name="AdditionalFeed" placeholder="Additional Feedback"></textarea>
                        </div>
                    </div>
                </div>
                <!-- Select Basic -->
                <div class="form-group required">
                    <div class="col-sm-9">
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" name="Travel_option" value="true" /><strong>I need travel arranged for me</strong></label>
                        </div>
                    </div>
                </div>
                <span class="help-block" id="checkboxVal1"></span>
                <!-- Select Basic -->
                <div class="form-group required">
                    <div class="col-sm-9">
                        <div class="checkbox">
                            <label>
                                <input class="checkboxVal" type="checkbox" name="Additional_option" value="true" /><strong>I am bringing others with me</strong></label>
                        </div>
                    </div>
                </div>
                <div class="form-group hidenshow">
                    <label class="col-sm-3 control-label">Additional Person 1</label>
                    <div class="col-sm-9 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <input name="AddFirstName1" placeholder="Additional Person 1 First Name" class="form-control" type="text">
                        </div>
                    </div>
                </div>
                <!-- Text input-->
                <div class="form-group hidenshow">
                    <label class="col-sm-3 control-label"></label>
                    <div class="col-sm-9 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <input name="AddSurname1" placeholder="Additional Person 1 Last Name" class="form-control" type="text">
                        </div>
                    </div>
                </div>
                <div class="form-group hidenshow">
                    <label class="col-sm-3 control-label">Additional Person 2</label>
                    <div class="col-sm-9 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <input name="AddFirstName2" placeholder="Additional Person 2 First Name" class="form-control" type="text">
                        </div>
                    </div>
                </div>
                <!-- Text input-->
                <div class="form-group hidenshow">
                    <label class="col-sm-3 control-label"></label>
                    <div class="col-sm-9 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <input name="AddSurname2" placeholder="Additional Person 2 Last Name" class="form-control" type="text">
                        </div>
                    </div>
                </div>
                <div class="form-group hidenshow">
                    <label class="col-sm-3 control-label">Additional Person 3</label>
                    <div class="col-sm-9 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <input name="AddFirstName3" placeholder="Additional Person 3 First Name" class="form-control" type="text">
                        </div>
                    </div>
                </div>
                <!-- Text input-->
                <div class="form-group hidenshow">
                    <label class="col-sm-3 control-label"></label>
                    <div class="col-sm-9 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <input name="AddSurname4" placeholder="Additional Person 3 Last Name" class="form-control" type="text">
                        </div>
                    </div>
                </div>
                <div class="form-group hidenshow">
                    <label class="col-sm-3 control-label">Additional Person 4</label>
                    <div class="col-sm-9 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <input name="AddFirstName4" placeholder="Additional Person 4 First Name" class="form-control" type="text">
                        </div>
                    </div>
                </div>
                <!-- Text input-->
                <div class="form-group hidenshow">
                    <label class="col-sm-3 control-label"></label>
                    <div class="col-sm-9 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <input name="AddSurname4" placeholder="Additional Person 4 Last Name" class="form-control" type="text">
                        </div>
                    </div>
                </div>
                <div class="form-group m-x-40">
                    <label class="col-sm-3 control-label"></label>
                    <div class="col-sm-9">
                        <button type="submit" class="btn btn-warning" name="FormSubmit">Submit <span class="glyphicon glyphicon-send"></span></button>
                    </div>
                </div>
            </fieldset>
            <!-- hidden fields -->
            <!--<input type="hidden" name="__successPage" id="__successPage" value="=CloudPagesURL(333)=">
            <input type="hidden" name="__errorPage" id="__errorPage" value="=CloudPagesURL(332)=">-->
            <input type="hidden" name="__contextName" id="__contextName" value="profileFormPost">
            <input type="hidden" name="__executionContext" id="__executionContext" value="POST">
            <input type="hidden" name="RSVP_Submit_Date" value="%%=SystemDateToLocalDate(Now())=%%">

            <!-- end hidden fields -->
        </form>
    </div>
        <footer class="text-center"><p>&copy; Autism CRC 2017</p></footer>
    </div>
    <!-- /.container -->
    %%[[name="profileFormPost";type="POST"]

      
        SET @FirstName = RequestParameter("FirstName")
        SET @Surname = RequestParameter("Surname")
        SET @email = RequestParameter("email")

        SET @SubFirstName = RequestParameter("SubFirstName")
        SET @SubSurname = RequestParameter("SubSurname")
        SET @Subemail = RequestParameter("Subemail")

        SET @Travel_option = IIF(RequestParameter("Travel_option")=='true',1,0)
        SET @Additional_option = IIF(RequestParameter("Additional_option")=='true',1,0)
        SET @AdditionalFeed = RequestParameter("AdditionalFeed")

        SET @AddFirstName1 = RequestParameter("AddFirstName1")
        SET @AddSurname1 = RequestParameter("AddSurname1")

        SET @AddFirstName2 = RequestParameter("AddFirstName2")
        SET @AddSurname2 = RequestParameter("AddSurname2")

        SET @AddFirstName3 = RequestParameter("AddFirstName3")
        SET @AddSurname3 = RequestParameter("AddSurname3")

        SET @AddFirstName4 = RequestParameter("AddFirstName4")
        SET @AddSurname4 = RequestParameter("AddSurname4")

        SET @RSVP_Submit_Date = RequestParameter("RSVP_Submit_Date")
 

 /* Update DE */

      SET @status =
        InsertData
        (
        "RSVP_Test", 
        "FirstName", @FirstName,
        "Surname", @Surname,
        "email", @email,
        
        "SubFirstName", @SubFirstName,
        "SubSurname", @SubSurname,
        "Subemail", @Subemail,
        
        "Travel_option", @Travel_option,
        "Additional_option", @Additional_option,
        "AdditionalFeed", @AdditionalFeed,
        
        "AddFirstName1", @AddFirstName1,
        "AddSurname1", @AddSurname1,

        "AddFirstName2", @AddFirstName2,
        "AddSurname2", @AddSurname2,

        "AddFirstName3", @AddFirstName3,
        "AddSurname3", @AddSurname3,

        "AddFirstName4", @AddFirstName4,
        "AddSurname4", @AddSurname4,

        "RSVP_Submit_Date", @RSVP_Submit_Date
        )

        /* Triggered Send */
        var @emailaddr, @ts, @tsDef, @ts_subkey, @ts_sub, @ts_statusCode, @errorCode

        SET @emailaddr = "brad.sapkota@gmail.com"

        SET @ts = CreateObject("TriggeredSend")
        SET @tsDef = CreateObject("TriggeredSendDefinition")
        SET @ts_subkey = @emailaddr

        SetObjectProperty(@tsDef, "CustomerKey", "1853602")
        SetObjectProperty(@ts, "TriggeredSendDefinition", @tsDef)

        SET @ts_sub = CreateObject("Subscriber")
        SetObjectProperty(@ts_sub, "SubscriberKey", @ts_subkey)
        SetObjectProperty(@ts_sub, "EmailAddress", @ts_subkey)

        SET @attr1 = CreateObject("Attribute")
        SET @attr2 = CreateObject("Attribute")
        SET @attr3 = CreateObject("Attribute")
        SET @attr4 = CreateObject("Attribute")
        SET @attr5 = CreateObject("Attribute")
        SET @attr6 = CreateObject("Attribute")
        SET @attr7 = CreateObject("Attribute")
        SET @attr8 = CreateObject("Attribute")
        SET @attr9 = CreateObject("Attribute")
        SET @attr10 = CreateObject("Attribute")
        SET @attr11 = CreateObject("Attribute")
        SET @attr12 = CreateObject("Attribute")
        SET @attr13 = CreateObject("Attribute")
        SET @attr14 = CreateObject("Attribute")
        SET @attr15 = CreateObject("Attribute")
        SET @attr16 = CreateObject("Attribute")
        SET @attr17 = CreateObject("Attribute")
        SET @attr18 = CreateObject("Attribute")

        SetObjectProperty(@attr1, "Name", "FirstName")
        SetObjectProperty(@attr2, "Name", "Surname")
        SetObjectProperty(@attr3, "Name", "email")
        SetObjectProperty(@attr4, "Name", "SubFirstName")
        SetObjectProperty(@attr5, "Name", "SubSurname")
        SetObjectProperty(@attr6, "Name", "Subemail")
        SetObjectProperty(@attr7, "Name", "Travel_option")
        SetObjectProperty(@attr8, "Name", "Additional_option")
        SetObjectProperty(@attr9, "Name", "AdditionalFeed")

        SetObjectProperty(@attr10, "Name", "AddFirstName1")
        SetObjectProperty(@attr11, "Name", "AddSurname1")
        SetObjectProperty(@attr12, "Name", "AddFirstName2")
        SetObjectProperty(@attr13, "Name", "AddSurname2")
        SetObjectProperty(@attr14, "Name", "AddFirstName3")
        SetObjectProperty(@attr15, "Name", "AddSurname3")
        SetObjectProperty(@attr16, "Name", "AddFirstName4")
        SetObjectProperty(@attr17, "Name", "AddSurname4")
        SetObjectProperty(@attr18, "Name", "RSVP_Submit_Date")

        SetObjectProperty(@attr1, "Value", @FirstName)
        SetObjectProperty(@attr2, "Value", @Surname)
        SetObjectProperty(@attr3, "Value", @email)
        SetObjectProperty(@attr4, "Value", @SubFirstName)
        SetObjectProperty(@attr5, "Value", @SubSurname)
        SetObjectProperty(@attr6, "Value", @Subemail)
        SetObjectProperty(@attr7, "Value", @Travel_option)
        SetObjectProperty(@attr8, "Value", @Additional_option)
        SetObjectProperty(@attr9, "Value", @AdditionalFeed)

        SetObjectProperty(@attr10, "Value", @AddFirstName1)
        SetObjectProperty(@attr11, "Value", @AddSurname1)
        SetObjectProperty(@attr12, "Value", @AddFirstName2)
        SetObjectProperty(@attr13, "Value", @AddSurname2)
        SetObjectProperty(@attr14, "Value", @AddFirstName3)
        SetObjectProperty(@attr15, "Value", @AddSurname3)
        SetObjectProperty(@attr16, "Value", @AddFirstName4)
        SetObjectProperty(@attr17, "Value", @AddSurname4)
        SetObjectProperty(@attr18, "Value", @RSVP_Submit_Date)

        AddObjectArrayItem(@ts_sub, "Attributes", @attr1)
        AddObjectArrayItem(@ts_sub, "Attributes", @attr2)
        AddObjectArrayItem(@ts_sub, "Attributes", @attr3)
        AddObjectArrayItem(@ts_sub, "Attributes", @attr4)
        AddObjectArrayItem(@ts_sub, "Attributes", @attr5)
        AddObjectArrayItem(@ts_sub, "Attributes", @attr6)
        AddObjectArrayItem(@ts_sub, "Attributes", @attr7)
        AddObjectArrayItem(@ts_sub, "Attributes", @attr8)
        AddObjectArrayItem(@ts_sub, "Attributes", @attr9)

        AddObjectArrayItem(@ts_sub, "Attributes", @attr10)
        AddObjectArrayItem(@ts_sub, "Attributes", @attr11)
        AddObjectArrayItem(@ts_sub, "Attributes", @attr12)
        AddObjectArrayItem(@ts_sub, "Attributes", @attr13)
        AddObjectArrayItem(@ts_sub, "Attributes", @attr14)
        AddObjectArrayItem(@ts_sub, "Attributes", @attr15)
        AddObjectArrayItem(@ts_sub, "Attributes", @attr16)
        AddObjectArrayItem(@ts_sub, "Attributes", @attr17)
        AddObjectArrayItem(@ts_sub, "Attributes", @attr18)

        AddObjectArrayItem(@ts, "Subscribers", @ts_sub)
        SET @ts_statusCode = InvokeCreate(@ts, @ts_statusMsg, @errorCode)

    IF @updateStatus == 1 AND @ts_statusCode == "OK" THEN
            Redirect("http://www.google.com")
        ELSE
            Redirect("http://www.yahoo.com")
      ]%%

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
    <script src='http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js'></script>
    <script src='http://cdnjs.cloudflare.com/ajax/libs/bootstrap-validator/0.4.5/js/bootstrapvalidator.min.js'></script>
    <script type="text/javascript">
   $('.checkboxVal').click(function() {
    if( $(this).is(':checked')) {
        $(".hidenshow").show();
    } else {
        $(".hidenshow").hide();
    }
}); 
$(document).ready(function(){
    $('#attendance_opt').on('change', function() {
      if ( this.value == 'Substitute_Attending')
      {
        $(".hidenshow1").show();
      }
      else
      {
        $(".hidenshow1").hide();
      }
    });
});
    </script>
    <script type="text/javascript">
    $(document).ready(function() {
        $('#contact_form').bootstrapValidator({
            // To use feedback icons, ensure that you use Bootstrap v3.1.0 or later
            //feedbackIcons: {
            // valid: 'glyphicon glyphicon-ok',
            // invalid: 'glyphicon glyphicon-remove',
            // validating: 'glyphicon glyphicon-refresh'
            // },
            fields: {
                FirstName: {
                    validators: {
                        notEmpty: {
                            message: 'Please supply your first name'
                        }
                    }
                },
                Surname: {
                    validators: {
                        notEmpty: {
                            message: 'Please supply your surname'
                        }
                    }
                },
                email: {
                    validators: {
                        notEmpty: {
                            message: 'Please enter your email address'
                        },
                        emailAddress: {
                            message: 'The value is not a valid email address'
                        }
                    }
                },
                SubFirstName: {
                    validators: {
                        notEmpty: {
                            message: 'Please supply your first name'
                        }
                    }
                },
                SubSurname: {
                    validators: {
                        notEmpty: {
                            message: 'Please supply your surname'
                        }
                    }
                },
                Subemail: {
                    validators: {
                        notEmpty: {
                            message: 'Please enter your email address'
                        },
                        emailAddress: {
                            message: 'The value is not a valid email address'
                        }
                    }
                },
                Attendance_option: {
                    validators: {
                        notEmpty: {
                            message: 'Please select a value'
                        }
                    }
                }
                /*,
                AdditionalFeed: {
                    validators: {
                        notEmpty: {
                            message: 'Please supply your feedback'
                        }
                    }
                }
                ,
                checkboxVal: {
                    selector: ".checkboxVal",
                    validators: {
                        notEmpty: {
                            message: 'Please select a value'
                        }
                    }
                },
                checkboxVal1: {
                    selector: ".checkboxVal1",
                    validators: {
                        notEmpty: {
                            message: 'Please select this option'
                        }
                    }
                }
                */
            }
        })


        .on('success.form.bv', function(e) {
            $('#success_message').slideDown({
                    opacity: "show"
                }, "slow") // Do something ...
            $('#contact_form').data('bootstrapValidator').resetForm();

            // Prevent form submission
            e.preventDefault();

            // Get the form instance
            var $form = $(e.target);

            // Get the BootstrapValidator instance
            var bv = $form.data('bootstrapValidator');

            // Use Ajax to submit form data
            $.post($form.attr('action'), $form.serialize(), function(result) {
                console.log(result);
            }, 'json');

        });

    });
    </script>
</body>

</html>
